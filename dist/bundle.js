(()=>{"use strict";var t,r=function(t){var r=document.querySelector(t);if(this.context=r.getContext("webgl2"),null==this.context)return console.error("Error in intializing WebGLRenderContext for canvas element with id: ",t),void alert("Unable to initialize WebGL2. Your browser or machine may not support it.");this.context.clearColor(0,0,0,.8),this.context.clearDepth(1),this.context.enable(this.context.DEPTH_TEST),this.context.depthFunc(this.context.LEQUAL)},e=function(){function t(){}return t.registerCanvas=function(t){if(null==this.intanceById.get(t)){var e=new r(t);this.intanceById.set(t,e),null==this.currContext&&(this.currContext=e.context)}else console.log("Trying to create dupilcate GLContext for canvas element with id: ",t)},t.CurrContext=function(){return t.currContext},t.SetCurrContext=function(r){var e=t.intanceById.get(r);null==e&&console.log("No GLContext is present in for the canvas element with id: ",r),t.currContext=e.context},t.intanceById=new Map,t.currContext=null,t}(),n=function(){function t(){if(this.glProgram=e.CurrContext().createProgram(),null==this.glProgram)throw console.log("Error in creating GLProgram Object."),new Error("Error in creating GLProgram Object.");if(this.glVAO=e.CurrContext().createVertexArray(),null==this.glVAO)throw console.log("Error in creating WebGLVertexArrayObject."),new Error("Error in creating WebGLVertexArrayObject.");this.gameObjectsList=new Array}return t.prototype.addGameObject=function(t){this.gameObjectsList.push(t)},t.prototype.draw=function(t){var r=this;this.setToContext(),t.setToContext(this.perspIdx,this.viewIdx),this.gameObjectsList.forEach((function(t){r.updateBuffersFromGameObject(t),t.draw()}))},t.prototype.createShader=function(t,r){var n=e.CurrContext(),o=n.createShader(r);if(n.shaderSource(o,t),n.compileShader(o),!n.getShaderParameter(o,n.COMPILE_STATUS))throw console.log("Error in creating Shader Object."),new Error("Error in creating Shader Object.");return o},t.prototype.linkShaders=function(){var t=e.CurrContext();if(t.linkProgram(this.glProgram),!t.getProgramParameter(this.glProgram,t.LINK_STATUS))throw console.log("Error in Linking Shaders"),new Error("Error in Linking Shaders")},t}(),o=(t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function r(){var r=t.call(this)||this;if(r.vsSource="\n    attribute vec4 aVertexPosition;\n    uniform mat4 uWorldMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    void main() {\n    gl_Position = uProjectionMatrix * uViewMatrix * uWorldMatrix * aVertexPosition;\n    }\n    ",r.psSource="\n    \n    void main() {\n      gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n  ",r.posBuff=e.CurrContext().createBuffer(),r.createAndLinkShaders(),r.createVAO(),null==r.posBuff)throw console.log("Error in creating Vertex Buffer"),new Error("Error in creating Vertex Buffer");return r}return o(r,t),r.prototype.createAndLinkShaders=function(){var t=this.createShader(this.vsSource,WebGL2RenderingContext.VERTEX_SHADER);e.CurrContext().attachShader(this.glProgram,t);var r=this.createShader(this.psSource,WebGL2RenderingContext.FRAGMENT_SHADER);e.CurrContext().attachShader(this.glProgram,r),this.linkShaders(),this.getUniformLocations()},r.prototype.createVAO=function(){var t=e.CurrContext(),r=t.getAttribLocation(this.glProgram,"aVertexPosition");t.bindVertexArray(this.glVAO),t.bindBuffer(t.ARRAY_BUFFER,this.posBuff),t.bufferData(t.ARRAY_BUFFER,120,t.DYNAMIC_DRAW),t.vertexAttribPointer(r,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r),t.bindVertexArray(null)},r.prototype.getUniformLocations=function(){var t=e.CurrContext();this.perspIdx=t.getUniformLocation(this.glProgram,"uProjectionMatrix"),this.viewIdx=t.getUniformLocation(this.glProgram,"uViewMatrix")},r.prototype.setToContext=function(){var t=e.CurrContext();t.useProgram(this.glProgram),t.bindVertexArray(this.glVAO)},r.prototype.updateBuffersFromGameObject=function(t){var r=e.CurrContext();null!=t.model.posData?(r.bindBuffer(r.ARRAY_BUFFER,this.posBuff),r.bufferSubData(r.ARRAY_BUFFER,0,t.model.posData)):console.log("No Pos Data avaliable from game Object. This data is required in vertex Shader.");var n=r.getUniformLocation(this.glProgram,"uWorldMatrix");r.uniformMatrix4fv(n,!1,t.world)},r}(n),a=function(){function t(t){this._indexData=t,this.posData=null,this.colData=null,this.indicesCount=t.length,this.createIndexBuffer(t)}return t.prototype.draw=function(){e.CurrContext().bindBuffer(WebGL2RenderingContext.ELEMENT_ARRAY_BUFFER,this.indexBuff),e.CurrContext().drawElements(WebGL2RenderingContext.TRIANGLE_STRIP,this.indicesCount,WebGL2RenderingContext.UNSIGNED_SHORT,0)},t.prototype.createIndexBuffer=function(t){var r=e.CurrContext();this.indexBuff=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuff),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),r.STATIC_DRAW)},t}(),u=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),c=function(t){function r(){var e=t.call(this,r.indices)||this;return e.posData=new Float32Array([0,1,0,-1,0,0,1,0,0]),e}return u(r,t),r.indices=new Uint16Array([0,1,2]),r}(a),s=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),f=function(t){function r(){var e=t.call(this,r.indices)||this;return e.posData=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),e}return s(r,t),r.indices=new Uint16Array([0,1,2,0,2,3]),r}(a),l=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array;function h(){var t=new p(3);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function d(t){var r=new p(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function x(t,r,e){var n=new p(3);return n[0]=t,n[1]=r,n[2]=e,n}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});function y(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}h(),function(){var t;t=new p(4),p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var g,v=function(t){var r=new p(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r};function b(){var t=new p(16);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}h(),x(1,0,0),x(0,1,0),y(),y(),g=new p(9),p!=Float32Array&&(g[1]=0,g[2]=0,g[3]=0,g[5]=0,g[6]=0,g[7]=0),g[0]=1,g[4]=1,g[8]=1;var A,C,_=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),m=function(t){function r(r,e,n){var o=t.call(this)||this;return o.model=r,o.texture=n,o.trans=d(e.trans),o.rotQuat=v(e.rotQuat),o.scale=d(e.scale),o.world=b(),function(t,r,e,n){var o=r[0],i=r[1],a=r[2],u=r[3],c=o+o,s=i+i,f=a+a,l=o*c,p=o*s,h=o*f,d=i*s,x=i*f,y=a*f,g=u*c,v=u*s,b=u*f,A=n[0],C=n[1],_=n[2];t[0]=(1-(d+y))*A,t[1]=(p+b)*A,t[2]=(h-v)*A,t[3]=0,t[4]=(p-b)*C,t[5]=(1-(l+y))*C,t[6]=(x+g)*C,t[7]=0,t[8]=(h+v)*_,t[9]=(x-g)*_,t[10]=(1-(l+d))*_,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1}(o.world,o.rotQuat,o.trans,o.scale),o}return _(r,t),r.prototype.draw=function(){null!=this.texture&&this.texture.SetToContext(),this.model.draw()},r}((function(t,r){this.next=null!=r?r:null,this.prev=null!=t?t:null})),w=function(){this.trans=h(),this.rotQuat=y(),this.scale=d([1,1,1])},R=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),E=function(t){function r(r,e){return t.call(this,r,e)||this}return R(r,t),r.create=function(t,e){return new r(t,e)},r.createDefault=function(t){return new r(t,new w)},r.prototype.update=function(){},r}(m),P=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),O=function(t){function r(r,e,n,o){var i=t.call(this,r,e,e.texture)||this;return i.transBy=null==n?h():d(n),i.rotQuatLocallyBy=null==o?y():v(o),i.loaclTransform=b(),i}return P(r,t),r.prototype.update=function(){(function(t,r,e){var n=r[0],o=r[1],i=r[2],a=r[3],u=n+n,c=o+o,s=i+i,f=n*u,l=n*c,p=n*s,h=o*c,d=o*s,x=i*s,y=a*u,g=a*c,v=a*s;t[0]=1-(h+x),t[1]=l+v,t[2]=p-g,t[3]=0,t[4]=l-v,t[5]=1-(f+x),t[6]=d+y,t[7]=0,t[8]=p+g,t[9]=d-y,t[10]=1-(f+h),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1})(this.loaclTransform,this.rotQuatLocallyBy,this.transBy),function(t,r,e){var n=r[0],o=r[1],i=r[2],a=r[3],u=r[4],c=r[5],s=r[6],f=r[7],l=r[8],p=r[9],h=r[10],d=r[11],x=r[12],y=r[13],g=r[14],v=r[15],b=e[0],A=e[1],C=e[2],_=e[3];t[0]=b*n+A*u+C*l+_*x,t[1]=b*o+A*c+C*p+_*y,t[2]=b*i+A*s+C*h+_*g,t[3]=b*a+A*f+C*d+_*v,b=e[4],A=e[5],C=e[6],_=e[7],t[4]=b*n+A*u+C*l+_*x,t[5]=b*o+A*c+C*p+_*y,t[6]=b*i+A*s+C*h+_*g,t[7]=b*a+A*f+C*d+_*v,b=e[8],A=e[9],C=e[10],_=e[11],t[8]=b*n+A*u+C*l+_*x,t[9]=b*o+A*c+C*p+_*y,t[10]=b*i+A*s+C*h+_*g,t[11]=b*a+A*f+C*d+_*v,b=e[12],A=e[13],C=e[14],_=e[15],t[12]=b*n+A*u+C*l+_*x,t[13]=b*o+A*c+C*p+_*y,t[14]=b*i+A*s+C*h+_*g,t[15]=b*a+A*f+C*d+_*v}(this.world,this.world,this.loaclTransform)},r}(m),T=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),L=function(t){function r(){var e=t.call(this,r.indices)||this;return e.posData=new Float32Array([0,.5,0,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5]),e.colData=new Float32Array([1,0,0,1,0,1,0,1,0,0,1,1,1,1,1,1]),e.uvData=new Float32Array([.5,0,0,1,1,1,0,1,1,1]),e}return T(r,t),r.indices=new Uint16Array([0,1,2,0,2,3,0,3,4,0,4,1,1,4,3,1,3,2]),r}(a),B=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),S=function(t){function r(){var r=t.call(this)||this;if(r.vsSource="\n    precision mediump float;\n    attribute vec4 aVertexPosition;\n    attribute vec4 aColor;\n\n    uniform mat4 uWorldMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    varying vec4 vertColor;\n    void main() {\n    gl_Position = uProjectionMatrix * uViewMatrix * uWorldMatrix * aVertexPosition;\n    vertColor = aColor;\n    }\n    ",r.psSource="\n    precision mediump float;\n    varying vec4 vertColor;\n\n    void main() {\n      gl_FragColor = vec4(vertColor);\n    }\n  ",r.posBuff=e.CurrContext().createBuffer(),r.colBuff=e.CurrContext().createBuffer(),r.createAndLinkShaders(),r.createVAO(),null==r.posBuff)throw console.log("Error in creating Vertex Buffer"),new Error("Error in creating Vertex Buffer");return r}return B(r,t),r.prototype.createAndLinkShaders=function(){var t=e.CurrContext(),r=this.createShader(this.vsSource,t.VERTEX_SHADER);t.attachShader(this.glProgram,r);var n=this.createShader(this.psSource,t.FRAGMENT_SHADER);t.attachShader(this.glProgram,n),this.linkShaders(),this.getUniformLocations()},r.prototype.createVAO=function(){var t=e.CurrContext(),r=t.getAttribLocation(this.glProgram,"aVertexPosition"),n=t.getAttribLocation(this.glProgram,"aColor");t.bindVertexArray(this.glVAO),t.bindBuffer(t.ARRAY_BUFFER,this.posBuff),t.bufferData(t.ARRAY_BUFFER,120,t.DYNAMIC_DRAW),t.vertexAttribPointer(r,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,this.colBuff),t.bufferData(t.ARRAY_BUFFER,120,t.DYNAMIC_DRAW),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n),t.bindVertexArray(null)},r.prototype.getUniformLocations=function(){var t=e.CurrContext();this.perspIdx=t.getUniformLocation(this.glProgram,"uProjectionMatrix"),this.viewIdx=t.getUniformLocation(this.glProgram,"uViewMatrix")},r.prototype.setToContext=function(){var t=e.CurrContext();t.useProgram(this.glProgram),t.bindVertexArray(this.glVAO)},r.prototype.updateBuffersFromGameObject=function(t){var r=e.CurrContext();null!=t.model.posData?(r.bindBuffer(r.ARRAY_BUFFER,this.posBuff),r.bufferSubData(r.ARRAY_BUFFER,0,t.model.posData),r.bindBuffer(r.ARRAY_BUFFER,this.colBuff),r.bufferSubData(r.ARRAY_BUFFER,0,t.model.colData)):console.log("No Pos Data avaliable from game Object. This data is required in vertex Shader.");var n=r.getUniformLocation(this.glProgram,"uWorldMatrix");r.uniformMatrix4fv(n,!1,t.world)},r}(n),F=function(){function t(r,n){this.fileName=r,this.getImageData=function(r){return new Promise((function(e){var n=new Image;return n.addEventListener("load",(function(){return e(n)})),n.src=t.textureRelPath+r,n}))},this.texObj=e.CurrContext().createTexture(),this.initializeTextureObject(),0==r.length?console.error("Invalid image file provided in texture object creation."):this.LoadImage(r,n)}return t.prototype.LoadImage=function(t,r){return n=this,o=void 0,a=function(){var n,o,i,a;return function(t,r){var e,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(e=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=r.call(t,i)}catch(t){u=[6,t],n=0}finally{e=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(u){switch(u.label){case 0:return[4,this.getImageData(t)];case 1:return n=u.sent(),e.CurrContext().bindTexture(WebGL2RenderingContext.TEXTURE_2D,this.texObj),o=r?WebGL2RenderingContext.RGBA:WebGL2RenderingContext.RGB,i=o,a=WebGL2RenderingContext.UNSIGNED_BYTE,e.CurrContext().texImage2D(WebGL2RenderingContext.TEXTURE_2D,0,o,i,a,n),[2]}}))},new((i=void 0)||(i=Promise))((function(t,r){function e(t){try{c(a.next(t))}catch(t){r(t)}}function u(t){try{c(a.throw(t))}catch(t){r(t)}}function c(r){var n;r.done?t(r.value):(n=r.value,n instanceof i?n:new i((function(t){t(n)}))).then(e,u)}c((a=a.apply(n,o||[])).next())}));var n,o,i,a},t.prototype.initializeTextureObject=function(){e.CurrContext().bindTexture(WebGL2RenderingContext.TEXTURE_2D,this.texObj),e.CurrContext().texImage2D(WebGL2RenderingContext.TEXTURE_2D,0,WebGL2RenderingContext.RGBA,1,1,0,WebGL2RenderingContext.RGBA,WebGL2RenderingContext.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),e.CurrContext().texParameteri(WebGL2RenderingContext.TEXTURE_2D,WebGL2RenderingContext.TEXTURE_WRAP_S,WebGL2RenderingContext.CLAMP_TO_EDGE),e.CurrContext().texParameteri(WebGL2RenderingContext.TEXTURE_2D,WebGL2RenderingContext.TEXTURE_WRAP_T,WebGL2RenderingContext.CLAMP_TO_EDGE),e.CurrContext().texParameteri(WebGL2RenderingContext.TEXTURE_2D,WebGL2RenderingContext.TEXTURE_MIN_FILTER,WebGL2RenderingContext.NEAREST),e.CurrContext().texParameteri(WebGL2RenderingContext.TEXTURE_2D,WebGL2RenderingContext.TEXTURE_MAG_FILTER,WebGL2RenderingContext.LINEAR)},t.prototype.SetToContext=function(){e.CurrContext().bindTexture(WebGL2RenderingContext.TEXTURE_2D,this.texObj)},t.textureRelPath="../../textures/",t}(),M=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),j=function(t){function r(){var r=t.call(this)||this;if(r.vsSource="\n    precision mediump float;\n    attribute vec4 aVertexPosition;\n    attribute vec2 aTexCoord;\n\n    uniform mat4 uWorldMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    varying vec2 uvCoord;\n\n    void main() {\n    gl_Position = uProjectionMatrix * uViewMatrix * uWorldMatrix * aVertexPosition;\n    uvCoord = aTexCoord;\n    }\n    ",r.psSource="\n    precision mediump float;\n\n    uniform sampler2D tex2DSampler;\n\n    varying vec2 uvCoord;\n    void main() {\n        gl_FragColor = texture2D(tex2DSampler, uvCoord);\n    }\n    ",r.posBuff=e.CurrContext().createBuffer(),r.uvBuff=e.CurrContext().createBuffer(),r.createAndLinkShaders(),r.createVAO(),null==r.posBuff)throw console.log("Error in creating Vertex Buffer"),new Error("Error in creating Vertex Buffer");return r}return M(r,t),r.prototype.createAndLinkShaders=function(){var t=e.CurrContext(),r=this.createShader(this.vsSource,t.VERTEX_SHADER);t.attachShader(this.glProgram,r);var n=this.createShader(this.psSource,t.FRAGMENT_SHADER);t.attachShader(this.glProgram,n),this.linkShaders(),this.getUniformLocations()},r.prototype.createVAO=function(){var t=e.CurrContext(),r=t.getAttribLocation(this.glProgram,"aVertexPosition"),n=t.getAttribLocation(this.glProgram,"aTexCoord");t.bindVertexArray(this.glVAO),t.bindBuffer(t.ARRAY_BUFFER,this.posBuff),t.bufferData(t.ARRAY_BUFFER,120,t.DYNAMIC_DRAW),t.vertexAttribPointer(r,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuff),t.bufferData(t.ARRAY_BUFFER,60,t.DYNAMIC_DRAW),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n),t.bindVertexArray(null)},r.prototype.getUniformLocations=function(){var t=e.CurrContext();this.perspIdx=t.getUniformLocation(this.glProgram,"uProjectionMatrix"),this.viewIdx=t.getUniformLocation(this.glProgram,"uViewMatrix")},r.prototype.setToContext=function(){var t=e.CurrContext();t.useProgram(this.glProgram),t.bindVertexArray(this.glVAO)},r.prototype.updateBuffersFromGameObject=function(t){var r=e.CurrContext();null!=t.model.posData?(r.bindBuffer(r.ARRAY_BUFFER,this.posBuff),r.bufferSubData(r.ARRAY_BUFFER,0,t.model.posData),r.bindBuffer(r.ARRAY_BUFFER,this.uvBuff),r.bufferSubData(r.ARRAY_BUFFER,0,t.model.uvData)):console.log("No Pos Data avaliable from game Object. This data is required in vertex Shader.");var n=r.getUniformLocation(this.glProgram,"uWorldMatrix");r.uniformMatrix4fv(n,!1,t.world)},r}(n),D=function(){function t(){this.shaderList=new Array(10)}return t.GetInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.AddShader=function(t){this.shaderList.push(t)},t.prototype.Execute=function(t){this.shaderList.forEach((function(r,e,n){r.draw(t)}))},t.instance=null,t}(),G=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),U=function(t){function r(r){var e=t.call(this)||this;return e.privReset(r),e}return G(r,t),r.prototype.First=function(){this.curr=this.root},r.prototype.Next=function(){null!=this.curr&&(this.curr=this.curr.next)},r.prototype.IsDone=function(){return null==this.curr},r.prototype.Current=function(){return this.curr},r.prototype.Reset=function(t){this.privReset(t)},r.prototype.privReset=function(t){this.root=t,this.curr=null},r}((function(){})),V=function(){function t(){this.count=0,this.root=null,this.forwardItr=new U(null)}return t.prototype.AddElement=function(t){return null!=t&&(null!=this.root&&(t.next=this.root,this.root.prev=t),this.root=t,this.count++),t},t.prototype.RemoveElement=function(t){if(null==t||null==t)return null;null!=t.prev?t.prev.next=t.next:this.root=t.next,null!=t.next&&(t.next.prev=t.prev),this.count--},t.prototype.GetForwardItr=function(t){return null==t?this.forwardItr.Reset(this.root):this.forwardItr.Reset(t),this.forwardItr},t}(),I=function(){function t(){this.dlinkMan=new V}return t.prototype.Add=function(t){this.dlinkMan.AddElement(t)},t.prototype.Remove=function(t){this.dlinkMan.RemoveElement(t)},t.prototype.Update=function(){var t=this.dlinkMan.GetForwardItr();for(t.First();!t.IsDone();t.Next())t.Current().update()},t}(),W=function(){function t(){this.projectionMatrix=b(),this.viewMatrix=b()}return t.prototype.updateViewMatrix=function(t,r,e){!function(t,r,e,n){var o,i,a,u,c,s,f,p,h,d,x=r[0],y=r[1],g=r[2],v=n[0],b=n[1],A=n[2],C=e[0],_=e[1],m=e[2];Math.abs(x-C)<l&&Math.abs(y-_)<l&&Math.abs(g-m)<l?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(f=x-C,p=y-_,h=g-m,o=b*(h*=d=1/Math.hypot(f,p,h))-A*(p*=d),i=A*(f*=d)-v*h,a=v*p-b*f,(d=Math.hypot(o,i,a))?(o*=d=1/d,i*=d,a*=d):(o=0,i=0,a=0),u=p*a-h*i,c=h*o-f*a,s=f*i-p*o,(d=Math.hypot(u,c,s))?(u*=d=1/d,c*=d,s*=d):(u=0,c=0,s=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=i,t[5]=c,t[6]=p,t[7]=0,t[8]=a,t[9]=s,t[10]=h,t[11]=0,t[12]=-(o*x+i*y+a*g),t[13]=-(u*x+c*y+s*g),t[14]=-(f*x+p*y+h*g),t[15]=1)}(this.viewMatrix,e,r,t)},t.prototype.updateProjMatrix=function(t,r,e,n){!function(t,r,e,n,o){var i,a=1/Math.tan(r/2);t[0]=a/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(i=1/(n-o),t[10]=(o+n)*i,t[14]=2*o*n*i):(t[10]=-1,t[14]=-2*n)}(this.projectionMatrix,t,r,e,n)},t.prototype.setToContext=function(t,r){var n=e.CurrContext();n.uniformMatrix4fv(t,!1,this.projectionMatrix),n.uniformMatrix4fv(r,!1,this.viewMatrix)},t}(),Y=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])},t(r,e)};return function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),N=function(t){function r(){return t.call(this)||this}return Y(r,t),r}(W);window.onload=function(){e.registerCanvas("#gLCanvas"),C=new I,(A=new N).updateProjMatrix(45*Math.PI/180,1,.1,100),A.updateViewMatrix([0,1,0],[0,0,-1.5],[0,0,1]);var t=new i;D.GetInstance().AddShader(t);var r=new S;D.GetInstance().AddShader(r);var n=new j;D.GetInstance().AddShader(n),new c;var o=new f,a=new L,u=new F("GreenGrass_RGB.png",!1),s=new w;s.trans=d([-1.5,1,-7]);var l=E.create(o,s);t.addGameObject(l),C.Add(l),s.trans=d([.5,-.4,-3]),s.texture=u;var p=new O(a,s,null,v([.001,0,0,1]));n.addGameObject(p),C.Add(p)},window.requestAnimationFrame((function t(){C.Update();var r=e.CurrContext();null!=r&&(r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),D.GetInstance().Execute(A)),window.requestAnimationFrame(t)}))})();